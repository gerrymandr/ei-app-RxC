box()
segments(x0=38, y0=100, x1=92, y1=0)
segments(x0=0, y=61, x1=100, y1=7, col='blue', lwd=5)
dev.off()
pdf('bounds2.pdf', width=6, height=5)
plot(x, y, main='Bounds plot', axes=F,
type='n', xlab='White Republicans', ylab='Black Republicans')
axis(1, at=c(0,100), cex.axis=0.8)
axis(1, at=c(38,92))
axis(2, at=c(0,100), cex.axis=0.8)
axis(2, at=c(7,61))
box()
segments(x0=38, y0=100, x1=92, y1=0, col='red', lwd=5)
segments(x0=0, y=61, x1=100, y1=7, col='blue', lwd=5)
dev.off()
plot(x, y, main='Bounds plot', axes=F,
type='n', xlab='White Republicans', ylab='Black Republicans')
axis(1, at=c(0,100), cex.axis=0.8)
axis(1, at=c(38,92))
axis(1, at=c(84,89))
axis(2, at=c(0,100), cex.axis=0.8)
box()
segments(x0=38, y0=100, x1=92, y1=0, col='red', lwd=5)
segments(x0=84, y=100, x1=89, y1=0, col='red', lwd=5)
text(84, 100, '84', pos=2)
text(84, 95, '84', pos=2)
text('White pop=65%', 50, 50, pos=2)
text(50, 50, 'White pop=65%', pos=2)
text(85,50, 'White pop=95%', pos=2)
pdf('bounds3.pdf', width=6, height=5)
plot(x, y, main='Bounds plot', axes=F,
type='n', xlab='White Republicans', ylab='Black Republicans')
axis(1, at=c(0,100), cex.axis=0.8)
axis(1, at=c(38,92))
axis(1, at=c(89))
axis(2, at=c(0,100), cex.axis=0.8)
box()
segments(x0=38, y0=100, x1=92, y1=0, col='red', lwd=5)
segments(x0=84, y=100, x1=89, y1=0, col='red', lwd=5)
text(84, 95, '84', pos=2)
text(50,50, 'White pop=65%', pos=2, cex=0.8)
text(85,85, 'White pop=95%', pos=2, cex=0.8)
dev.off()
plot(x, y, main='Bounds plot', axes=F,
type='n', xlab='White Republicans', ylab='Black Republicans')
axis(1, at=c(0,100), cex.axis=0.8)
axis(1, at=c(38,92))
axis(1, at=c(89))
axis(2, at=c(0,100), cex.axis=0.8)
box()
segments(x0=38, y0=100, x1=92, y1=0, col='red', lwd=5)
segments(x0=84, y=100, x1=89, y1=0, col='red', lwd=5)
text(84, 95, '84', pos=2)
text(50,50, 'White pop=65%', pos=2, cex=0.8)
text(85,85, 'White pop=95%', pos=2, cex=0.8)
pdf('bounds3.pdf', width=6, height=5)
plot(x, y, main='Bounds plot', axes=F,
type='n', xlab='White Republicans', ylab='Black Republicans')
axis(1, at=c(0,100), cex.axis=0.8)
axis(1, at=c(38,92))
axis(1, at=c(89))
axis(2, at=c(0,100), cex.axis=0.8)
box()
segments(x0=38, y0=100, x1=92, y1=0, col='red', lwd=5)
segments(x0=84, y=100, x1=89, y1=0, col='red', lwd=5)
text(84, 95, '84', pos=2)
text(50,50, 'White pop=65%', pos=2, cex=0.8)
text(85,75, 'White pop=95%', pos=2, cex=0.8)
dev.off()
pdf('bounds3.pdf', width=6, height=5)
plot(x, y, main='Bounds plot', axes=F,
type='n', xlab='White Republicans', ylab='Black Republicans')
axis(1, at=c(0,100), cex.axis=0.8)
axis(1, at=c(38,92))
axis(1, at=c(89))
axis(2, at=c(0,100), cex.axis=0.8)
box()
segments(x0=38, y0=100, x1=92, y1=0, col='red', lwd=5)
segments(x0=84, y=100, x1=89, y1=0, col='red', lwd=5)
text(84, 95, '84', pos=2)
text(60,50, 'White pop=65%', pos=2, cex=0.8)
text(85,75, 'White pop=95%', pos=2, cex=0.8)
dev.off()
pdf('bounds3.pdf', width=6, height=5)
plot(x, y, main='Bounds plot', axes=F,
type='n', xlab='White Republicans', ylab='Black Republicans')
axis(1, at=c(0,100), cex.axis=0.8)
axis(1, at=c(38,92), cex.axis=0.8)
axis(1, at=c(89), cex.axis=0.8)
axis(2, at=c(0,100), cex.axis=0.8)
box()
segments(x0=38, y0=100, x1=92, y1=0, col='red', lwd=5)
segments(x0=84, y=100, x1=89, y1=0, col='red', lwd=5)
text(84, 95, '84', pos=2)
text(60,50, 'White pop=65%', pos=2, cex=0.8)
text(85,75, 'White pop=95%', pos=2, cex=0.8)
dev.off()
pdf('bounds3.pdf', width=6, height=5)
plot(x, y, main='Bounds plot', axes=F,
type='n', xlab='White Republicans', ylab='Black Republicans')
axis(1, at=c(0,100), cex.axis=0.8)
axis(1, at=c(38,92), cex.axis=0.7)
axis(1, at=c(89), cex.axis=0.7)
axis(2, at=c(0,100), cex.axis=0.8)
box()
segments(x0=38, y0=100, x1=92, y1=0, col='red', lwd=5)
segments(x0=84, y=100, x1=89, y1=0, col='red', lwd=5)
text(84, 95, '84', pos=2)
text(60,50, 'White pop=65%', pos=2, cex=0.8)
text(85,75, 'White pop=95%', pos=2, cex=0.8)
dev.off()
plot(w, y, type='n')
plot(x, y, type='n')
segments(x0=0, y0=1.85, x1=100, y1=-.14)
segments(x0=0, y0=185, x1=100, y1=-14)
plot(x, y, main='Bounds plot', axes=F,
type='n', xlab='White Republicans', ylab='Black Republicans')
axis(1, at=c(0,100), cex.axis=0.8)
axis(1, at=c(38,92))
axis(2, at=c(0,100), cex.axis=0.8)
box()
segments(x0=38, y0=100, x1=92, y1=0, col='red', lwd=5)
segments(x0=0, y0=185, x1=100, y1=-14)
segments(x0=61, y=0, x1=7, y1=100, col='blue', lwd=5)
pdf('bounds2.pdf', width=6, height=5)
plot(x, y, main='Bounds plot', axes=F,
type='n', xlab='White Republicans', ylab='Black Republicans')
axis(1, at=c(0,100), cex.axis=0.8)
axis(1, at=c(38,92))
axis(2, at=c(0,100), cex.axis=0.8)
axis(2, at=c(7,61))
box()
segments(x0=38, y0=100, x1=92, y1=0, col='red', lwd=5)
segments(x0=61, y=0, x1=7, y1=100, col='blue', lwd=5)
dev.off()
pdf('bounds2.pdf', width=6, height=5)
plot(x, y, main='Bounds plot', axes=F,
type='n', xlab='White Republicans', ylab='Black Republicans')
axis(1, at=c(0,100), cex.axis=0.8)
axis(1, at=c(38,92))
axis(2, at=c(0,100), cex.axis=0.8)
axis(1, at=c(7,61))
box()
segments(x0=38, y0=100, x1=92, y1=0, col='red', lwd=5)
segments(x0=61, y=0, x1=7, y1=100, col='blue', lwd=5)
dev.off()
pdf('bounds1a.pdf', width=6, height=5)
plot(x, y, main='Bounds plot', axes=F,
type='n', xlab='White Republicans', ylab='Black Republicans')
axis(1, at=c(0,100), cex.axis=0.8)
axis(1, at=c(38,92))
axis(2, at=c(0,100), cex.axis=0.8)
box()
segments(x0=38, y0=100, x1=92, y1=0, col='red', lwd=5)
#segments(x0=0, y0=185, x1=100, y1=-14)
text(60,50, 'White pop=65%', pos=2, cex=0.8)
dev.off()
rm(list=ls())
challenge.df = matrix(c(10,90,200,100), nrow = 2)
challenge.df
challenge.df = matrix(c(10,200,90,100), nrow = 2)
challenge.df = matrix(c(10,200,90,100), nrow = 2)
challenge.df
fisher.test(challenge.df)
x <- fisher.test(challenge.df)
class(x)
x
x$alternative
summary(x)
rm(list-ls())
rm(challenge.df)
rm(x)
r1 <- 100
r2 <- 300
c1 <- 210
c2 <- 190
m <- matrix(r1, r2, c1, c2, row=2)
m <- matrix(r1, r2, c1, c2, nrow=2)
m <- matrix(c(r1,r2,c1,c2), nrow=2)
m
m <- matrix(c(NA,NA,c1,NA,NA,c2,r1,r2,sum(c(r1,r2,c1,c2))), nrow=3)
m
m <- matrix(c(NA,NA,c1,NA,NA,c2,r1,r2,sum(c(r1,r2))), nrow=3)
m
min(m)
min(!is.na(m))
is.na(m)
min(m[!is.na(m)])
1:min(m[!is.na(m)])
r1 <- 100
r2 <- 300
c1 <- 210
c2 <- 190
m <- matrix(c(NA,NA,c1,NA,NA,c2,r1,r2,sum(c(r1,r2))), nrow=3)
m
df <- data.frame(beta.11=NA, beta.12, NA, beta.21=NA, beta.22=NA)
df
df <- data.frame(beta.11=NA, beta.12, NA, beta.21=NA, beta.22=NA)
doug <- data.frame(doug='doug', kat='kat')
doug
df <- data.frame(beta.11=NA, beta.12=NA, beta.21=NA, beta.22=NA)
df
min.m <- min(m[!is.na(m)])
df <- data.frame(beta.11=rep(NA,min.m), beta.12=rep(NA,min.m), beta.21=rep(NA,min.m), beta.22=rep(NA,min.m)
for (i in 1:min(m[!is.na(m)])){
beta.11 <- i
beta.12 <- r1-i
beta.21 <- c1-i
beta.22 <- r2-beta.21
}
df <- data.frame(beta.11=rep(NA,min.m),
beta.12=rep(NA,min.m),
beta.21=rep(NA,min.m),
beta.22=rep(NA,min.m))
df
for (i in 1:min.m){
df$beta.11[i] <- i
df$beta.12[i] <- r1-i
df$beta.21[i] <- c1-i
df$beta.22[i] <- r2-beta.21
}
df <- data.frame(beta.11=rep(NA,min.m),
beta.12=rep(NA,min.m),
beta.21=rep(NA,min.m),
beta.22=rep(NA,min.m))
for (i in 1:min.m){
df$beta.11[i] <- i
df$beta.12[i] <- r1-i
df$beta.21[i] <- c1-i
df$beta.22[i] <- r2-beta.21
}
for (i in 1:min.m){
df$beta.11[i] <- i
df$beta.12[i] <- r1-i
df$beta.21[i] <- c1-i
df$beta.22[i] <- r2-df$beta.21
}
df
warnings()
for (i in 1:min.m){
df$beta.11[i] <- i
df$beta.12[i] <- r1-i
df$beta.21[i] <- c1-i
df$beta.22[i] <- r2-df$beta.21[i]
}
df
```{r setup, include=FALSE}
install.packages('rmarkdown')
```{r setup, include=FALSE}
```{r setup, include=FALSE}
---
title: Sesame Street County
date: Analyses Conducted on December 1, 2016
---
```{r}
setwd('~/Dropbox/tufts_mggg/hack/megan_gall_example/')
library(ei, warn.conflicts=FALSE, quietly=TRUE)
library(rmarkdown)
```
```{r}
EI_r1<-read.csv("1.sheriff_2006a.csv")
EI_r2<-read.csv("2.sheriff_2002.csv")
EI_r3<-read.csv("3.sheriff_2010.csv")
EI_r4<-read.csv("4.sheriff_2014.csv")
```
### Local Office - 2002 General
<center>N=`r NROW(EI_r2)`</center>
```{r, results='asis'}
r2c1<-ei(t_r2c1~x_r2b, total="n_r2", data=EI_r2)
save(r2c1, file = "r2c1")
r2c1b<-eiread(r2c1, "betab", "betaw")
r2c1bs<-na.omit(r2c1$betabs)
r2c1ws<-na.omit(r2c1$betaws)
r2c2<-ei(t_r2c2~x_r2b, total="n_r2", data=EI_r2)
save(r2c2, file = "r2c2")
r2c2b<-eiread(r2c2, "betab", "betaw")
r2c2bs<-na.omit(r2c2$betabs)
r2c2ws<-na.omit(r2c2$betaws)
```
Candidate|Mean(m)|Sup(m)|CIb(lwr)|CIb(upr)|Mean(w)|Sup(w)|CIw(lwr)|CIw(upr)|r|p|# Votes
--------|-----|------|-----|------|------|-----|-----|-----|------|----|----
Candidate1-b-D|`r round(mean(r2c1b$"betab", na.rm=TRUE), 4)`|`r round(mean(r2c1b$"betab", na.rm=TRUE)/(mean(r2c1b$"betab", na.rm=TRUE)+mean(r2c2b$"betab", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r2c1bs, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r2c1bs, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(mean(r2c1b$"betaw", na.rm=TRUE), 4)`|`r round(mean(r2c1b$"betaw", na.rm=TRUE)/(mean(r2c1b$"betaw", na.rm=TRUE)+mean(r2c2b$"betaw", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r2c1ws, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r2c1ws, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(with(EI_r2, cor.test(x_r2b,t_r2c1)$estimate), 4)`|`r round(with(EI_r2, cor.test(x_r2b,t_r2c1)$p.value), 4)`|`r sum(EI_r2$s_r2c1)`
Candidate2-w-R|`r round(mean(r2c2b$"betab", na.rm=TRUE), 4)`|`r round(mean(r2c2b$"betab", na.rm=TRUE)/(mean(r2c1b$"betab", na.rm=TRUE)+mean(r2c2b$"betab", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r2c2bs, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r2c2bs, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(mean(r2c2b$"betaw", na.rm=TRUE), 4)`|`r round(mean(r2c2b$"betaw", na.rm=TRUE)/(mean(r2c1b$"betaw", na.rm=TRUE)+mean(r2c2b$"betaw", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r2c2ws, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r2c2ws, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(with(EI_r2, cor.test(x_r2b,t_r2c2)$estimate), 4)`|`r round(with(EI_r2, cor.test(x_r2b,t_r2c2)$p.value), 4)`|`r sum(EI_r2$s_r2c2)`
### Local Office - 2006 General
<center>N=`r NROW(EI_r1)`</center>
```{r, results='asis'}
r1c1<-ei(t_r1c1~x_r1b, total="n_r1", erho=20, data=EI_r1)
save(r1c1, file = "r1c1")
r1c1b<-eiread(r1c1, "betab", "betaw")
r1c1bs<-na.omit(r1c1$betabs)
r1c1ws<-na.omit(r1c1$betaws)
r1c2<-ei(t_r1c2~x_r1b, total="n_r1", erho=2, data=EI_r1)
save(r1c2, file = "r1c2")
r1c2b<-eiread(r1c2, "betab", "betaw")
r1c2bs<-na.omit(r1c2$betabs)
r1c2ws<-na.omit(r1c2$betaws)
```
Candidate|Mean(m)|Sup(m)|CIb(lwr)|CIb(upr)|Mean(w)|Sup(w)|CIw(lwr)|CIw(upr)|r|p|# Votes
--------|-----|------|-----|------|------|-----|-----|-----|------|----|----
Candidate1-b-D|`r round(mean(r1c1b$"betab", na.rm=TRUE), 4)`|`r round(mean(r1c1b$"betab", na.rm=TRUE)/(mean(r1c1b$"betab", na.rm=TRUE)+mean(r1c2b$"betab", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r1c1bs, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r1c1bs, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(mean(r1c1b$"betaw", na.rm=TRUE), 4)`|`r round(mean(r1c1b$"betaw", na.rm=TRUE)/(mean(r1c1b$"betaw", na.rm=TRUE)+mean(r1c2b$"betaw", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r1c1ws, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r1c1ws, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(with(EI_r1, cor.test(x_r1b,t_r1c1)$estimate), 4)`|`r round(with(EI_r1, cor.test(x_r1b,t_r1c1)$p.value), 4)`|`r sum(EI_r1$s_r1c1)`
Candidate2-w-R!|`r round(mean(r1c2b$"betab", na.rm=TRUE), 4)`|`r round(mean(r1c2b$"betab", na.rm=TRUE)/(mean(r1c1b$"betab", na.rm=TRUE)+mean(r1c2b$"betab", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r1c2bs, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r1c2bs, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(mean(r1c2b$"betaw", na.rm=TRUE), 4)`|`r round(mean(r1c2b$"betaw", na.rm=TRUE)/(mean(r1c1b$"betaw", na.rm=TRUE)+mean(r1c2b$"betaw", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r1c2ws, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r1c2ws, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(with(EI_r1, cor.test(x_r1b,t_r1c2)$estimate), 4)`|`r round(with(EI_r1, cor.test(x_r1b,t_r1c2)$p.value), 4)`|`r sum(EI_r1$s_r1c2)`
### Local Office - 2010 General
<center>N=`r NROW(EI_r3)`</center>
```{r, results='asis'}
r3c1<-ei(t_r3c1~x_r3b, total="n_r3", data=EI_r3)
save(r3c1, file = "r3c1")
r3c1b<-eiread(r3c1, "betab", "betaw")
r3c1bs<-na.omit(r3c1$betabs)
r3c1ws<-na.omit(r3c1$betaws)
r3c2<-ei(t_r3c2~x_r3b, total="n_r3", data=EI_r3)
save(r3c2, file = "r3c2")
r3c2b<-eiread(r3c2, "betab", "betaw")
r3c2bs<-na.omit(r3c2$betabs)
r3c2ws<-na.omit(r3c2$betaws)
```
Candidate|Mean(m)|Sup(m)|CIb(lwr)|CIb(upr)|Mean(w)|Sup(w)|CIw(lwr)|CIw(upr)|r|p|# Votes
--------|-----|------|-----|------|------|-----|-----|-----|------|----|----
Candidate1-b-D!|`r round(mean(r3c1b$"betab", na.rm=TRUE), 4)`|`r round(mean(r3c1b$"betab", na.rm=TRUE)/(mean(r3c1b$"betab", na.rm=TRUE)+mean(r3c2b$"betab", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r3c1bs, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r3c1bs, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(mean(r3c1b$"betaw", na.rm=TRUE), 4)`|`r round(mean(r3c1b$"betaw", na.rm=TRUE)/(mean(r3c1b$"betaw", na.rm=TRUE)+mean(r3c2b$"betaw", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r3c1ws, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r3c1ws, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(with(EI_r3, cor.test(x_r3b,t_r3c1)$estimate), 4)`|`r round(with(EI_r3, cor.test(x_r3b,t_r3c1)$p.value), 4)`|`r sum(EI_r3$s_r3c1)`
Candidate2-w-R|`r round(mean(r3c2b$"betab", na.rm=TRUE), 4)`|`r round(mean(r3c2b$"betab", na.rm=TRUE)/(mean(r3c1b$"betab", na.rm=TRUE)+mean(r3c2b$"betab", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r3c2bs, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r3c2bs, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(mean(r3c2b$"betaw", na.rm=TRUE), 4)`|`r round(mean(r3c2b$"betaw", na.rm=TRUE)/(mean(r3c1b$"betaw", na.rm=TRUE)+mean(r3c2b$"betaw", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r3c2ws, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r3c2ws, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(with(EI_r3, cor.test(x_r3b,t_r3c2)$estimate), 4)`|`r round(with(EI_r3, cor.test(x_r3b,t_r3c2)$p.value), 4)`|`r sum(EI_r3$s_r3c2)`
### Local Office - 2014 General
<center>N=`r NROW(EI_r4)`</center>
```{r, results='asis'}
r4c1<-ei(t_r4c1~x_r4b, total="n_r4", data=EI_r4)
save(r4c1, file = "r4c1")
r4c1b<-eiread(r4c1, "betab", "betaw")
r4c1bs<-na.omit(r4c1$betabs)
r4c1ws<-na.omit(r4c1$betaws)
r4c2<-ei(t_r4c2~x_r4b, total="n_r4", data=EI_r4)
save(r4c2, file = "r4c2")
r4c2b<-eiread(r4c2, "betab", "betaw")
r4c2bs<-na.omit(r4c2$betabs)
r4c2ws<-na.omit(r4c2$betaws)
```
Candidate|Mean(m)|Sup(m)|CIb(lwr)|CIb(upr)|Mean(w)|Sup(w)|CIw(lwr)|CIw(upr)|r|p|# Votes
--------|-----|------|-----|------|------|-----|-----|-----|------|----|----
Candidate1-b-D|`r round(mean(r4c1b$"betab", na.rm=TRUE), 4)`|`r round(mean(r4c1b$"betab", na.rm=TRUE)/(mean(r4c1b$"betab", na.rm=TRUE)+mean(r4c2b$"betab", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r4c1bs, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r4c1bs, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(mean(r4c1b$"betaw", na.rm=TRUE), 4)`|`r round(mean(r4c1b$"betaw", na.rm=TRUE)/(mean(r4c1b$"betaw", na.rm=TRUE)+mean(r4c2b$"betaw", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r4c1ws, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r4c1ws, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(with(EI_r4, cor.test(x_r4b,t_r4c1)$estimate), 4)`|`r round(with(EI_r4, cor.test(x_r4b,t_r4c1)$p.value), 4)`|`r sum(EI_r4$s_r4c1)`
Candidate2-w-R!|`r round(mean(r4c2b$"betab", na.rm=TRUE), 4)`|`r round(mean(r4c2b$"betab", na.rm=TRUE)/(mean(r4c1b$"betab", na.rm=TRUE)+mean(r4c2b$"betab", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r4c2bs, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r4c2bs, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(mean(r4c2b$"betaw", na.rm=TRUE), 4)`|`r round(mean(r4c2b$"betaw", na.rm=TRUE)/(mean(r4c1b$"betaw", na.rm=TRUE)+mean(r4c2b$"betaw", na.rm=TRUE))*100, 2)`%|(`r round(mean(apply(r4c2ws, 1, function (x) quantile(x, probs=c(.025)))), 4)`|`r round(mean(apply(r4c2ws, 1, function (x) quantile(x, probs=c(.975)))), 4)`)|`r round(with(EI_r4, cor.test(x_r4b,t_r4c2)$estimate), 4)`|`r round(with(EI_r4, cor.test(x_r4b,t_r4c2)$p.value), 4)`|`r sum(EI_r4$s_r4c2)`
###Additional Information
Calculations are a function of voter turnout.
Candidate details include name-demographics-party-incumbency (example: Gall-w-NP! reads Gall-white-No Party-Incumbent).
Racially polarized voting is statistically significant if *r* > 0.5 or < -0.5 **and/or** *p-value* < 0.01 **and/or** the confidence intervals do not overlap.
render('DummyEI.Rmd', quiet=TRUE, html_document(toc=TRUE, theme='journal', quiet=TRUE))
setwd('~/Dropbox/tufts_mggg/hack/ei-app/data/')
rm(list=ls())
df <- read.csv('waterbury.csv', stringsAsFactors=F)
hp <- round(25/100*dim(df)[1], digits=0) # 25% homogeneous
hp.low <- 1:hp
hp.high <- (dim(df)[1]-hp):dim(df)[1]
df$threshold <- 0
df$threshold[hp.low] <- 1
df$threshold[hp.high] <-1
df$hp <- NA
df$hp[hp.low] <- 1
df$hp[hp.high] <- 1
df$hp.text <- NA
df$hp.text[hp.low] <- 'low'
df$hp.text[hp.high] <- 'high'
head(df)
hp.low.mean <- mean(df$y[df$hp.text=='low'], na.rm=T)
hp.high.mean <- mean(df$y[df$hp.text=='high'], na.rm=T)
hp.low.mean <- mean(df$Tom.Foley[df$hp.text=='low'], na.rm=T)
hp.high.mean <- mean(df$Tom.Foley[df$hp.text=='high'], na.rm=T)
ger <- lm(Tom.Foley~Hisp.pct, data=df)
names(df)
ger <- lm(Tom.Foley~Hisp.Pct, data=df)
ger <- lm(Tom.Foley~Hispanic.Pct, data=df)
table.names <- c('ei.minority', 'ei.white')
ei.out <- ei_est_gen('Tom.Foley', '~ Hispanic.Pct', 'Total.Votes',
data = df[,c(1:3),], table_names = table.names, sample=1000) # eiCompare
library(ei)
library(ei)
install.packages('ei')
library(eiPack)
library(eiCompare)
install.packages('eiCompare')
library(eiCompare)
ei.out <- ei_est_gen('Tom.Foley', '~ Hispanic.Pct', 'Total.Votes',
data = df[,c(1:3),], table_names = table.names, sample=1000) # eiCompare
ei.out <- ei(Tom.Foley~Hispanic.Pct, total=df$Total.Votes, data=df) # ei
ei.out <- ei(df$Tom.Foley~df$Hispanic.Pct, total=df$Total.Votes, data=df) # ei
ei.out <- ei(Tom.Foley~Hispanic.Pct, data=df, total=df$Total.Votes, data=df) # ei
?ei.out
?ei
ei.out <- ei(Tom.Foley~cbind(Hispanic.Pct,Black.Pct),total=df$Total.Votes, data=df) # ei
names(df)
ei(Tom.Foley~Hispanic.Pct, total=df$Total.Votes, data-df)
ei(Tom.Foley~Hispanic.Pct, total=Total.Votes, data-df)
ei(Tom.Foley~Hispanic.Pct, total=df$Total.Votes, data=df)
names(df)
ei.out <- ei_est_gen('Tom.Foley', '~ Hispanic.Pct', 'Total.Votes',
data = df[,c(3,7,2),], table_names = table.names, sample=1000) # eiCompare
ei.out <- ei_est_gen('Tom.Foley', '~ Hispanic.Pct + Black.Pct', 'Total.Votes',
data = df[,c(3,7,2),], table_names = table.names, sample=1000) # eiCompare
?ei_est_gen
ei.out <- ei(Tom.Foley~cbind(Hispanic.Pct,Black.Pct),total=df$Total.Votes, data=df) # ei
ei.out <- ei(Tom.Foley~Hispanic.Pct, total=df$Total.Votes, data=df)
?ei
ei.out <- ei('Tom.Foley~Hispanic.Pct', total=df$Total.Votes, data=df)
ei.out <- ei(Tom.Foley~Hispanic.Pct, total=df$Total.Votes, data=df)
library(ei)
library(eiPack)
library(eiCompare)
ei.out <- ei(Tom.Foley~Hispanic.Pct, total=df$Total.Votes, data=df)
ei.out <- ei(Tom.Foley~cbind(Hispanic.Pct,Black.Pct),total=df$Total.Votes, data=df) # ei
ei.out <- ei(Tom.Foley~Hispanic.Pct, total=df$Total.Votes, data=df)
install.packages('ei')
install.packages("ei")
library(ei)
df <- read.csv('waterbury.csv', stringsAsFactors=F)
df <- df[order(df$Hispanic.Pct),]
hp <- round(25/100*dim(df)[1], digits=0) # 25% homogeneous
hp.low <- 1:hp
hp.high <- (dim(df)[1]-hp):dim(df)[1]
df$threshold <- 0
df$threshold[hp.low] <- 1
df$threshold[hp.high] <-1
df$hp <- NA
df$hp[hp.low] <- 1
df$hp[hp.high] <- 1
df$hp.text <- NA
df$hp.text[hp.low] <- 'low'
df$hp.text[hp.high] <- 'high'
hp.low.mean <- mean(df$Tom.Foley[df$hp.text=='low'], na.rm=T)
hp.high.mean <- mean(df$Tom.Foley[df$hp.text=='high'], na.rm=T)
ger <- lm(Tom.Foley~Hispanic.Pct, data=df)
summary(ger)
table.names <- c('ei.minority', 'ei.white')
tables.names
table.names <- c('ei.minority', 'ei.white')
table.names
ei.out <- ei_est_gen('Tom.Foley', '~ Hispanic.Pct', 'Total.Votes',
data = df[,c(3,7,2),], table_names = table.names, sample=1000) # eiCompare
library(ei)
library(eiPack)
library(eiCompare)
setwd('~/Dropbox/tufts_mggg/hack/ei-app/data/')
df <- read.csv('waterbury.csv', stringsAsFactors=F)
df <- df[order(df$Hispanic.Pct),]
hp <- round(25/100*dim(df)[1], digits=0) # 25% homogeneous
hp.low <- 1:hp
hp.high <- (dim(df)[1]-hp):dim(df)[1]
df$threshold <- 0
df$threshold[hp.low] <- 1
df$threshold[hp.high] <-1
df$hp <- NA
df$hp[hp.low] <- 1
df$hp[hp.high] <- 1
df$hp.text <- NA
df$hp.text[hp.low] <- 'low'
df$hp.text[hp.high] <- 'high'
hp.low.mean <- mean(df$Tom.Foley[df$hp.text=='low'], na.rm=T)
hp.high.mean <- mean(df$Tom.Foley[df$hp.text=='high'], na.rm=T)
ger <- lm(Tom.Foley~Hispanic.Pct, data=df)
table.names <- c('ei.minority', 'ei.white')
ei.out <- ei_est_gen('Tom.Foley', '~ Hispanic.Pct', 'Total.Votes',
data = df[,c(3,7,2),], table_names = table.names, sample=1000) # eiCompare
ei.out$ei.minority
ei.out
e2 <- ei(Tom.Foley~Hispanic.Pct, total=df$Total.Votes, data=df)
edf.t <- data.frame(w=c('White support',
hp.low.mean,
ger$coefficients[1],
ei.out$ei.white[1]/100,
ei.out$ei.white[2]/100),
m=c(paste(input$independent, ' support', sep=''),
hp.high.mean,
ger$coefficients[1]+ger$coefficients[2],
ei.out$ei.minority[1]/100,
ei.out$ei.minority[2]/100))
row.names(edf.t) <- c(input$dependent, 'Homogeneous precincts', 'Goodman ER', 'Ecol Inf', 'EI.se')
edf.t <- data.frame(w=c('White support',
hp.low.mean,
ger$coefficients[1],
ei.out$ei.white[1]/100,
ei.out$ei.white[2]/100),
m=c(paste('Tom.Foley', ' support', sep=''),
hp.high.mean,
ger$coefficients[1]+ger$coefficients[2],
ei.out$ei.minority[1]/100,
ei.out$ei.minority[2]/100))
row.names(edf.t) <- c(input$dependent, 'Homogeneous precincts', 'Goodman ER', 'Ecol Inf', 'EI.se')
edf.t <- data.frame(w=c('White support',
hp.low.mean,
ger$coefficients[1],
ei.out$ei.white[1]/100,
ei.out$ei.white[2]/100),
m=c(paste('Tom.Foley', ' support', sep=''),
hp.high.mean,
ger$coefficients[1]+ger$coefficients[2],
ei.out$ei.minority[1]/100,
ei.out$ei.minority[2]/100))
row.names(edf.t) <- c('Tom.Foley', 'Homogeneous precincts', 'Goodman ER', 'Ecol Inf', 'EI.se')
edf.t
print(ei.out)
ei.out
ei.out
ei.out$ei.white
eiedt.t
edf.t
edf.t <- data.frame(white=c('White support',
hp.low.mean,                # white homogeneous precincts
ger$coefficients[1],        # ecol. regression at 0
ei.out$ei.white[1]/100,     # ei estimate for whites
ei.out$ei.white[2]/100),    # se for ei estimate of whites
minority=c(paste('Tom.Foley', ' support', sep=''),
hp.high.mean,               # minority homogeneous precincts
ger$coefficients[1]+ger$coefficients[2], # regression at 1
ei.out$ei.minority[1]/100,  # ei estimates for minority
ei.out$ei.minority[2]/100)) # se for ei est of minority
row.names(edf.t) <- c('Tom.Foley', 'Homogeneous precincts', 'Goodman ER', 'Ecol Inf', 'EI.se')
edf.t
print(edf.t)
